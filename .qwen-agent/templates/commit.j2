feat: refactor {{ target_file.split('/').pop() | default('unknown') }}

- Applied safe refactoring per Qwen Agent workflow
- Updated logic for clarity and maintainability
- Added corresponding test coverage

Co-authored-by: Qwen Code Agent <qwen@local>